<!DOCTYPE html>
<html>
<body>
  <h1>ESP32 Analog Reader</h1>
  <button onclick="connectBLE()">Connexion BLE</button>
  <p id="value">Valeur: 0</p>

<script>
let characteristic;

async function connectBLE() {
  try {
    const device = await navigator.bluetooth.requestDevice({
      filters: [{ name: 'ESP32-S3_ANALOG' }],
      optionalServices: [SERVICE_UUID]
    });
    
    const server = await device.gatt.connect();
    const service = await server.getPrimaryService(SERVICE_UUID);
    characteristic = await service.getCharacteristic(CHARACTERISTIC_UUID);
    
    characteristic.addEventListener('characteristicvaluechanged', event => {
      const value = new TextDecoder().decode(event.target.value);
      document.getElementById('value').textContent = `Valeur: ${value}`;
    });
    
    await characteristic.startNotifications();
  } catch(error) {
    console.error('Erreur:', error);
  }
}

const SERVICE_UUID = '4fafc201-1fb5-459e-8fcc-c5c9c331914b';
</script>
</body>
</html>

